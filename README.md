Spotify Tools
=============

[![Codacy Badge](https://api.codacy.com/project/badge/Grade/bf879eba5f1c4fd89f92b0f9407b345e)](https://www.codacy.com/app/harisekhon/spotify-tools)
[![CodeFactor](https://www.codefactor.io/repository/github/harisekhon/spotify-tools/badge)](https://www.codefactor.io/repository/github/harisekhon/spotify-tools)
[![Quality Gate Status](https://sonarcloud.io/api/project_badges/measure?project=HariSekhon_Spotify-tools&metric=alert_status)](https://sonarcloud.io/dashboard?id=HariSekhon_Spotify-tools)
[![Maintainability Rating](https://sonarcloud.io/api/project_badges/measure?project=HariSekhon_Spotify-tools&metric=sqale_rating)](https://sonarcloud.io/dashboard?id=HariSekhon_Spotify-tools)
[![Reliability Rating](https://sonarcloud.io/api/project_badges/measure?project=HariSekhon_Spotify-tools&metric=reliability_rating)](https://sonarcloud.io/dashboard?id=HariSekhon_Spotify-tools)
[![Security Rating](https://sonarcloud.io/api/project_badges/measure?project=HariSekhon_Spotify-tools&metric=security_rating)](https://sonarcloud.io/dashboard?id=HariSekhon_Spotify-tools)
[![GitHub stars](https://img.shields.io/github/stars/harisekhon/spotify-tools.svg)](https://github.com/harisekhon/spotify-tools/stargazers)
[![GitHub forks](https://img.shields.io/github/forks/harisekhon/spotify-tools.svg)](https://github.com/harisekhon/spotify-tools/network)
[![Platform](https://img.shields.io/badge/platform-Linux%20%7C%20OS%20X-blue.svg)](https://github.com/harisekhon/spotify-tools#spotify-tools)
<!--
[![DockerHub](https://img.shields.io/badge/docker-available-blue.svg)](https://hub.docker.com/r/harisekhon/nagios-plugins/)
[![](https://images.microbadger.com/badges/image/harisekhon/spotify-tools.svg)](http://microbadger.com/#/images/harisekhon/spotify-tools)
-->

[![Linux](https://img.shields.io/badge/OS-Linux-blue?logo=linux)](https://github.com/HariSekhon/spotify-tools#spotify-tools)
[![Mac](https://img.shields.io/badge/OS-Mac-blue?logo=apple)](https://github.com/HariSekhon/spotify-tools#spotify-tools)
[![CI Builds Overview](https://img.shields.io/badge/CI%20Builds-Overview%20Page-blue)](https://bitbucket.org/harisekhon/devops-bash-tools/src/master/STATUS.md)

[![Travis CI](https://img.shields.io/travis/harisekhon/Spotify-tools/master?logo=travis&label=Travis)](https://travis-ci.org/HariSekhon/Spotify-tools)
[![AppVeyor](https://img.shields.io/appveyor/build/harisekhon/Spotify-tools/master?logo=appveyor&label=AppVeyor)](https://ci.appveyor.com/project/HariSekhon/Spotify-tools/branch/master)
[![Drone](https://img.shields.io/drone/build/HariSekhon/Spotify-tools/master?logo=drone&label=Drone)](https://cloud.drone.io/HariSekhon/Spotify-tools)
[![CircleCI](https://circleci.com/gh/HariSekhon/Spotify-tools.svg?style=svg)](https://circleci.com/gh/HariSekhon/Spotify-tools)
[![Codeship Status for HariSekhon/Spotify-tools](https://app.codeship.com/projects/44957fe0-3c5f-0138-07d2-66210e546d42/status?branch=master)](https://app.codeship.com/projects/387244)
[![Shippable](https://img.shields.io/shippable/5e52c637b15ffc00071d8f84/master?label=Shippable)](https://app.shippable.com/github/HariSekhon/Spotify-tools/dashboard/jobs)
[![Codefresh](https://g.codefresh.io/api/badges/pipeline/harisekhon/GitHub%2FSpotify-tools?branch=master&key=eyJhbGciOiJIUzI1NiJ9.NWU1MmM5OGNiM2FiOWUzM2Y3ZDZmYjM3.O69674cW7vYom3v5JOGKXDbYgCVIJU9EWhXUMHl3zwA&type=cf-1)](https://g.codefresh.io/pipelines/edit/new/builds?id=5ec401171350573576125f8d&pipeline=Spotify-tools&projects=GitHub&projectId=5e52ca8ea284e00f882ea992&rightbar=steps&advanced=0&context=github&filter=page:1;pageSize:10;timeFrameStart:week)
[![Wercker](https://app.wercker.com/status/c46a517909343e278c9ce354164394ae/s/master "wercker status")](https://app.wercker.com/harisekhon/Spotify-tools/runs)
[![BuildKite](https://img.shields.io/buildkite/cb0dcf2e1eed7a2c3d6035b8c5ca1bf4a741c1153b89688fcf/master?label=BuildKite)](https://buildkite.com/hari-sekhon/Spotify-tools)
[![Cirrus CI](https://img.shields.io/cirrus/github/HariSekhon/Spotify-tools/master?logo=Cirrus%20CI&label=Cirrus%20CI)](https://cirrus-ci.com/github/HariSekhon/Spotify-tools)
[![Semaphore](https://harisekhon.semaphoreci.com/badges/Spotify-tools.svg)](https://harisekhon.semaphoreci.com/projects/Spotify-tools)
[![Concourse](https://img.shields.io/badge/Concourse-ready-blue)](https://github.com/HariSekhon/Spotify-tools/blob/master/.concourse.yml)
[![GoCD](https://img.shields.io/badge/GoCD-ready-blue)](https://github.com/HariSekhon/Spotify-tools/blob/master/.gocd.yml)
[![Jenkins](https://img.shields.io/badge/Jenkins-ready-blue)](https://github.com/HariSekhon/Spotify-tools/blob/master/Jenkinsfile)
<!--
[![Wercker](https://img.shields.io/wercker/ci/5ec40277728d7f43001aa790/master?label=Wercker)](https://app.wercker.com/harisekhon/Spotify-tools/runs)
-->

[![Azure DevOps](https://dev.azure.com/harisekhon/GitHub/_apis/build/status/HariSekhon.spotify-tools?branchName=master)](https://dev.azure.com/harisekhon/GitHub/_build/latest?definitionId=3&branchName=master)
[![BitBucket Pipeline](https://img.shields.io/bitbucket/pipelines/harisekhon/spotify-tools/master?logo=bitbucket&label=BitBucket)](https://bitbucket.org/harisekhon/spotify-tools/addon/pipelines/home#!/)
[![GitLab Pipeline](https://img.shields.io/gitlab/pipeline/harisekhon/spotify-tools?logo=gitlab&label=GitLab)](https://gitlab.com/HariSekhon/spotify-tools/pipelines)
[![Repo on GitHub](https://img.shields.io/badge/repo-GitHub-blue?logo=github)](https://github.com/HariSekhon/spotify-tools)
[![Repo on GitLab](https://img.shields.io/badge/repo-GitLab-blue?logo=gitlab)](https://gitlab.com/HariSekhon/spotify-tools)
[![Repo on BitBucket](https://img.shields.io/badge/repo-BitBucket-blue?logo=bitbucket)](https://bitbucket.org/HariSekhon/spotify-tools)

[![CI Mac](https://github.com/HariSekhon/spotify-tools/workflows/CI%20Mac/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+Mac%22)
[![CI Mac 10.15](https://github.com/HariSekhon/spotify-tools/workflows/CI%20Mac%2010.15/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+Mac+10.15%22)
[![CI Ubuntu](https://github.com/HariSekhon/spotify-tools/workflows/CI%20Ubuntu/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+Ubuntu%22)
[![CI Ubuntu 14.04](https://github.com/HariSekhon/spotify-tools/workflows/CI%20Ubuntu%2014.04/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+Ubuntu+14.04%22)
[![CI Ubuntu 16.04](https://github.com/HariSekhon/spotify-tools/workflows/CI%20Ubuntu%2016.04/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+Ubuntu+16.04%22)
[![CI Ubuntu 18.04](https://github.com/HariSekhon/spotify-tools/workflows/CI%20Ubuntu%2018.04/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+Ubuntu+18.04%22)
[![CI Ubuntu 20.04](https://github.com/HariSekhon/spotify-tools/workflows/CI%20Ubuntu%2020.04/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+Ubuntu+20.04%22)
[![CI Ubuntu GitHub](https://github.com/HariSekhon/spotify-tools/workflows/CI%20Ubuntu%20GitHub/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+Ubuntu+GitHub%22)
[![CI Debian](https://github.com/HariSekhon/spotify-tools/workflows/CI%20Debian/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+Debian%22)
[![CI Debian 8](https://github.com/HariSekhon/spotify-tools/workflows/CI%20Debian%208/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+Debian+8%22)
[![CI Debian 9](https://github.com/HariSekhon/spotify-tools/workflows/CI%20Debian%209/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+Debian+9%22)
[![CI Debian 10](https://github.com/HariSekhon/spotify-tools/workflows/CI%20Debian%2010/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+Debian+10%22)
[![CI CentOS](https://github.com/HariSekhon/spotify-tools/workflows/CI%20CentOS/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+CentOS%22)
[![CI CentOS 6](https://github.com/HariSekhon/spotify-tools/workflows/CI%20CentOS%206/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+CentOS+6%22)
[![CI CentOS 7](https://github.com/HariSekhon/spotify-tools/workflows/CI%20CentOS%207/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+CentOS+7%22)
[![CI CentOS 8](https://github.com/HariSekhon/spotify-tools/workflows/CI%20CentOS%208/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+CentOS+8%22)
[![CI Fedora](https://github.com/HariSekhon/spotify-tools/workflows/CI%20Fedora/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+Fedora%22)
[![CI Alpine](https://github.com/HariSekhon/spotify-tools/workflows/CI%20Alpine/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+Alpine%22)
[![CI Alpine 3](https://github.com/HariSekhon/spotify-tools/workflows/CI%20Alpine%203/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+Alpine+3%22)

A collection of Spotify API tools to make it easy to manage years of precious Spotify playlists.

- ```bash-tools/spotify_*.sh``` - [Spotify](https://www.spotify.com/) API scripts to
  - list all public playlists for any given user
  - backup all playlists or a selection of playlists by partial name or ID
  - download playlist contents as track URIs / `Artists - Track` / CSV format
  - convert Spotify track URIs to human readable `Artist - Track` / CSV format
  - iterate any command against all playlists - command can be templated with playlist name or ID which will be auto-populated on each iteration
  - convert a playlist name to an ID or an ID to a playlist name
  - generate a Spotify API token (used by all other bash scripts)
  - query any Spotify API endpoint with authentication (used by all other bash scripts)
- ```spotify-cmd.pl``` - Spotify desktop app control from the command line on Mac via AppleScript calls. Useful for automation that Mac HotKeys don't help with such as auto-nexting tracks every N seconds if you want to skip through sampling a playlist

### Quick Start ###

If you want to recover an entire deleted playlist, you can do that quickly in the Spotify web interface -> Account -> [Recover Playlists](https://www.spotify.com/uk/account/recover-playlists/) page.

For deleted songs in the desktop app, you can immediately press Control + Shift + Z on Windows or Control + Z on Mac to undo it.

This repo is for everything else - Backups, Conversions from HTTP URIs to readable "Artist - Track" format, tracking individual songs removed from playlists over time etc.

#### Ready to run Docker image #####

These programs and their pre-compiled dependencies can be found ready to run on [DockerHub](https://hub.docker.com/r/harisekhon/spotify-tools/).

List all programs:
```
docker run harisekhon/spotify-tools
```
Run any given program:
```
docker run harisekhon/spotify-tools <program> <args>
```

#### Automated Build from source #####

```
git clone https://github.com/harisekhon/spotify-tools
cd spotify-tools
make
```

This builds all dependencies after which the programs can be run.

Alternatively see the [Manual Setup](https://github.com/harisekhon/spotify-tools#manual-setup) section instead.

## Examples

### Backup Spotify Playlists

Downloads the list of public playlists to `playlists.txt` (names) and `spotify/playlists.txt` (IDs + names in TSV format)

For each playlist, downloads the list of playlist tracks to a file of the same name in both human and Spotify usable formats
`playlists/` files contain `Artist - Track` format, while `playlists/spotify/` files contain Spotify URI format (for restores)

```
./bash-tools/spotify_backup.sh
================================================================================
                         Running Spotify Playlists Backup
================================================================================

2020-07-05 01:23:41  Dumping list of Spotify playlists to spotify/playlists.txt

2020-07-05 01:23:43  Stripping spotify playlist IDs from spotify/playlists.txt => playlists.txt

2020-07-05 01:23:44  Backing up Spotify playlists to /Users/hari/github/spotify-tools/playlists

My Shazam Tracks => URIs => OK => Tracks => OK
Upbeat & Sexual Pop => URIs => OK => Tracks => OK
2019 06-07 Venice & Budapest => URIs => OK => Tracks => OK
2019 05 - Winchester => URIs => OK => Tracks => OK
2019 04 April - Bath => URIs => OK => Tracks => OK
2019 01 Jan - South Woodford => URIs => OK => Tracks => OK
2018 10 Oct - Dec => URIs => OK => Tracks => OK
2018 Gemma => URIs => OK => Tracks => OK
2018 Jan - London - A New Beginning => URIs => OK => Tracks => OK
2017 12 December Mix - Back in London Baby => URIs => OK => Tracks => OK
2017 11 November Mix - Copenhagen => URIs => OK => Tracks => OK
2017 10 October Mix - Copenhagen => URIs => OK => Tracks => OK
2017 09 September Mix - Copenhagen => URIs => OK => Tracks => OK
2017 08 August Mix - London & Copenhagen => URIs => OK => Tracks => OK
2017 07 July Mix - Johannesburg => URIs => OK => Tracks => OK
2017 06 June Mix - Johannesburg => URIs => OK => Tracks => OK
...
2020-07-05 01:41:42  Spotify playlists backup finished in 1078 seconds
````

### Convert Spotify URIs to Human readable Artist - Track

You can copy and paste the tracks from the Spotify desktop app or web player directly into text files, which puts them in Spotify URI format such as
```
http://open.spotify.com/track/61oGXsKgJOI0e3uS2wg1BV
http://open.spotify.com/track/1j6API7GnhE8MRRedK4bda
http://open.spotify.com/track/0RxFoUhB3mAI3qpgLSf7eM
```

Then convert this to readable Artist - Track form for saving independently of Spotify but running spotify-lookup.pl against the file

```
./bash-tools/spotify_track_uri_to_name.sh < Pendulum.txt
Pendulum - Watercolour
Pendulum - Witchcraft
Pendulum - The Island - Pt. I
...
```

You can also pipe the file through standard input or even feed one or more Spotify URIs as standard input in either format that Spotify uses

```
echo http://open.spotify.com/track/5TOYgNohZAFEPOtnchPhZS | ./bash-tools/spotify_track_uri_to_name.sh
Foo Fighters - Arlandria

echo spotify:track:5TOYgNohZAFEPOtnchPhZS | ./bash-tools/spotify_track_uri_to_name.sh
Foo Fighters - Arlandria
```

### Spotify Cmd --help ###

```
./spotify-cmd.pl --help

Command line interface to Spotify on Mac that leverages AppleScript

Useful for automation that Mac HotKeys don't help with, such as auto skipping
to next track every N secs to sample a playlist while working

usage: spotify-cmd.pl <command>

commands:

play            Play
pause / stop    Pause
playpause       Toggle Play/Pause
previous        Previous Track and print previous track information
next [secs]     Next Track and print next track information.
                Specifying optional secs will skip to next track
                every [secs] seconds. Handy for skipping through a playlist
                every 60 secs automatically and grabbing the good songs. Prints
                track information every time it skips to the next track

status          Show current track details

vol up          Turn volume up
vol down        Turn volume down
vol <1-100>     Set volume to number <1-100>

exit / quit     Exit Spotify

-q  --quiet      Quiet mode. Do not print track information or volume after
                 completing action
-t  --timeout    Timeout in secs (default: 10)
-v  --verbose    Verbose mode (-v, -vv, -vvv ...)
-h  --help       Print description and usage options
-V  --version    Print version and exit
```

#### Manual Setup ####

Enter the directory and run git submodule init and git submodule update to fetch my library repo:

```
git clone https://github.com/harisekhon/spotify-tools
cd spotify-tools
git submodule init
git submodule update
```

Then you will also need to fetch the following CPAN modules listed in `setup/cpan-requirements.txt` and `lib/setup/cpan-requirements.txt`:

Running the cpan command followed by the list of modules (as root) will fetch them for you, or you can use this script:

```
bash-tools/perl_cpanm_install.sh setup/cpan-requirements.txt lib/setup/cpan-requirements.txt
```

### Contributions ###

Patches, improvements and even general feedback are welcome in the form of GitHub pull requests and issue tickets.

### Updating ###

Run ```make update```. This will git pull and then git submodule update which is necessary to pick up corresponding library updates.
ndencies.

If you update often and want to just quickly git pull + submodule update but skip rebuilding all those dependencies each time then run ```make update-no-recompile``` (will miss new library dependencies - do full ```make update``` if you encounter issues).

[git.io/spotify](https://git.io/spotify)
