Spotify Tools
=============

[![Codacy Badge](https://api.codacy.com/project/badge/Grade/bf879eba5f1c4fd89f92b0f9407b345e)](https://www.codacy.com/app/harisekhon/spotify-tools)
[![CodeFactor](https://www.codefactor.io/repository/github/harisekhon/spotify-tools/badge)](https://www.codefactor.io/repository/github/harisekhon/spotify-tools)
[![Quality Gate Status](https://sonarcloud.io/api/project_badges/measure?project=HariSekhonSpotify-tools&metric=alert_status)](https://sonarcloud.io/dashboard?id=HariSekhon_Spotify-tools)
[![Maintainability Rating](https://sonarcloud.io/api/project_badges/measure?project=HariSekhonSpotify-tools&metric=sqale_rating)](https://sonarcloud.io/dashboard?id=HariSekhon_Spotify-tools)
[![Reliability Rating](https://sonarcloud.io/api/project_badges/measure?project=HariSekhonSpotify-tools&metric=reliability_rating)](https://sonarcloud.io/dashboard?id=HariSekhon_Spotify-tools)
[![Security Rating](https://sonarcloud.io/api/project_badges/measure?project=HariSekhonSpotify-tools&metric=security_rating)](https://sonarcloud.io/dashboard?id=HariSekhon_Spotify-tools)
[![GitHub stars](https://img.shields.io/github/stars/harisekhon/spotify-tools.svg)](https://github.com/harisekhon/spotify-tools/stargazers)
[![GitHub forks](https://img.shields.io/github/forks/harisekhon/spotify-tools.svg)](https://github.com/harisekhon/spotify-tools/network)
[![Platform](https://img.shields.io/badge/platform-Linux%20%7C%20OS%20X-blue.svg)](https://github.com/harisekhon/spotify-tools#spotify-tools)
<!--
[![DockerHub](https://img.shields.io/badge/docker-available-blue.svg)](https://hub.docker.com/r/harisekhon/nagios-plugins/)
[![](https://images.microbadger.com/badges/image/harisekhon/spotify-tools.svg)](http://microbadger.com/#/images/harisekhon/spotify-tools)
-->

[![Linux](https://img.shields.io/badge/OS-Linux-blue?logo=linux)](https://github.com/HariSekhon/spotify-tools#spotify-tools)
[![Mac](https://img.shields.io/badge/OS-Mac-blue?logo=apple)](https://github.com/HariSekhon/spotify-tools#spotify-tools)
[![CI Builds Overview](https://img.shields.io/badge/CI%20Builds-Overview%20Page-blue)](https://bitbucket.org/harisekhon/devops-bash-tools/src/master/STATUS.md)

[![Travis CI](https://img.shields.io/travis/harisekhon/Spotify-tools/master?logo=travis&label=Travis)](https://travis-ci.org/HariSekhon/Spotify-tools)
[![AppVeyor](https://img.shields.io/appveyor/build/harisekhon/Spotify-tools/master?logo=appveyor&label=AppVeyor)](https://ci.appveyor.com/project/HariSekhon/Spotify-tools/branch/master)
[![Drone](https://img.shields.io/drone/build/HariSekhon/Spotify-tools/master?logo=drone&label=Drone)](https://cloud.drone.io/HariSekhon/Spotify-tools)
[![CircleCI](https://circleci.com/gh/HariSekhon/Spotify-tools.svg?style=svg)](https://circleci.com/gh/HariSekhon/Spotify-tools)
[![Codeship Status for HariSekhon/Spotify-tools](https://app.codeship.com/projects/44957fe0-3c5f-0138-07d2-66210e546d42/status?branch=master)](https://app.codeship.com/projects/387244)
[![Shippable](https://img.shields.io/shippable/5e52c637b15ffc00071d8f84/master?label=Shippable)](https://app.shippable.com/github/HariSekhon/Spotify-tools/dashboard/jobs)
[![Codefresh](https://g.codefresh.io/api/badges/pipeline/harisekhon/GitHub%2FSpotify-tools?branch=master&key=eyJhbGciOiJIUzI1NiJ9.NWU1MmM5OGNiM2FiOWUzM2Y3ZDZmYjM3.O69674cW7vYom3v5JOGKXDbYgCVIJU9EWhXUMHl3zwA&type=cf-1)](https://g.codefresh.io/pipelines/edit/workflow?id=5ec401171350573576125f8d&pipeline=Spotify-tools&projects=GitHub&projectId=5e52ca8ea284e00f882ea992&rightbar=steps&advanced=0&context=github)
[![Wercker](https://app.wercker.com/status/5ec40277728d7f43001aa790/s/master "wercker status")](https://app.wercker.com/project/byKey/5ec40277728d7f43001aa790)
[![BuildKite](https://img.shields.io/buildkite/cb0dcf2e1eed7a2c3d6035b8c5ca1bf4a741c1153b89688fcf/master?label=BuildKite)](https://buildkite.com/hari-sekhon/Spotify-tools)
[![Cirrus CI](https://img.shields.io/cirrus/github/HariSekhon/Spotify-tools/master?logo=Cirrus%20CI&label=Cirrus%20CI)](https://cirrus-ci.com/github/HariSekhon/Spotify-tools)
[![Semaphore](https://harisekhon.semaphoreci.com/badges/Spotify-tools.svg)](https://harisekhon.semaphoreci.com/projects/Spotify-tools)
[![Concourse](https://img.shields.io/badge/Concourse-ready-blue)](https://github.com/HariSekhon/Spotify-tools/blob/master/.concourse.yml)
[![GoCD](https://img.shields.io/badge/GoCD-ready-blue)](https://github.com/HariSekhon/Spotify-tools/blob/master/.gocd.yml)
[![Jenkins](https://img.shields.io/badge/Jenkins-ready-blue)](https://github.com/HariSekhon/Spotify-tools/blob/master/Jenkinsfile)
<!--
[![Wercker](https://img.shields.io/wercker/ci/5e58eec714b91a0800356b5b/master?label=Wercker)](https://app.wercker.com/project/byKey/7af643f46ecad1311bc1200fd42e509b)
-->

[![Azure DevOps](https://dev.azure.com/harisekhon/GitHub/_apis/build/status/HariSekhon.spotify-tools?branchName=master)](https://dev.azure.com/harisekhon/GitHub/_build/latest?definitionId=3&branchName=master)
[![BitBucket Pipeline](https://img.shields.io/bitbucket/pipelines/harisekhon/spotify-tools/master?logo=bitbucket&label=BitBucket)](https://bitbucket.org/harisekhon/spotify-tools/addon/pipelines/home#!/)
[![GitLab Pipeline](https://img.shields.io/gitlab/pipeline/harisekhon/spotify-tools?logo=gitlab&label=GitLab)](https://gitlab.com/HariSekhon/spotify-tools/pipelines)
[![Repo on GitHub](https://img.shields.io/badge/repo-GitHub-blue?logo=github)](https://github.com/HariSekhon/spotify-tools)
[![Repo on GitLab](https://img.shields.io/badge/repo-GitLab-blue?logo=gitlab)](https://gitlab.com/HariSekhon/spotify-tools)
[![Repo on BitBucket](https://img.shields.io/badge/repo-BitBucket-blue?logo=bitbucket)](https://bitbucket.org/HariSekhon/spotify-tools)

[![CI Mac](https://github.com/HariSekhon/spotify-tools/workflows/CI%20Mac/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+Mac%22)
[![CI Mac 10.15](https://github.com/HariSekhon/spotify-tools/workflows/CI%20Mac%2010.15/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+Mac+10.15%22)
[![CI Ubuntu](https://github.com/HariSekhon/spotify-tools/workflows/CI%20Ubuntu/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+Ubuntu%22)
[![CI Ubuntu 14.04](https://github.com/HariSekhon/spotify-tools/workflows/CI%20Ubuntu%2014.04/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+Ubuntu+14.04%22)
[![CI Ubuntu 16.04](https://github.com/HariSekhon/spotify-tools/workflows/CI%20Ubuntu%2016.04/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+Ubuntu+16.04%22)
[![CI Ubuntu 18.04](https://github.com/HariSekhon/spotify-tools/workflows/CI%20Ubuntu%2018.04/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+Ubuntu+18.04%22)
[![CI Ubuntu 20.04](https://github.com/HariSekhon/spotify-tools/workflows/CI%20Ubuntu%2020.04/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+Ubuntu+20.04%22)
[![CI Ubuntu GitHub](https://github.com/HariSekhon/spotify-tools/workflows/CI%20Ubuntu%20GitHub/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+Ubuntu+GitHub%22)
[![CI Debian](https://github.com/HariSekhon/spotify-tools/workflows/CI%20Debian/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+Debian%22)
[![CI Debian 8](https://github.com/HariSekhon/spotify-tools/workflows/CI%20Debian%208/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+Debian+8%22)
[![CI Debian 9](https://github.com/HariSekhon/spotify-tools/workflows/CI%20Debian%209/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+Debian+9%22)
[![CI Debian 10](https://github.com/HariSekhon/spotify-tools/workflows/CI%20Debian%2010/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+Debian+10%22)
[![CI CentOS](https://github.com/HariSekhon/spotify-tools/workflows/CI%20CentOS/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+CentOS%22)
[![CI CentOS 6](https://github.com/HariSekhon/spotify-tools/workflows/CI%20CentOS%206/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+CentOS+6%22)
[![CI CentOS 7](https://github.com/HariSekhon/spotify-tools/workflows/CI%20CentOS%207/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+CentOS+7%22)
[![CI CentOS 8](https://github.com/HariSekhon/spotify-tools/workflows/CI%20CentOS%208/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+CentOS+8%22)
[![CI Fedora](https://github.com/HariSekhon/spotify-tools/workflows/CI%20Fedora/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+Fedora%22)
[![CI Alpine](https://github.com/HariSekhon/spotify-tools/workflows/CI%20Alpine/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+Alpine%22)
[![CI Alpine 3](https://github.com/HariSekhon/spotify-tools/workflows/CI%20Alpine%203/badge.svg)](https://github.com/HariSekhon/spotify-tools/actions?query=workflow%3A%22CI+Alpine+3%22)

Spotify Lookup - converts Spotify URIs to 'Artist - Track' form by querying the Spotify Metadata API. Works against lists of files or standard input as a unix filter program. Useful for keeping readable backups of your Spotify playlists.

Spotify Cmd - command line control of Spotify on Mac via AppleScript calls. Useful for automation that Mac HotKeys don't help with such as skipping tracks every N seconds if you want to flick through a playlist while working.

### Quick Start ###

#### Ready to run Docker image #####

These programs and their pre-compiled dependencies can be found ready to run on [DockerHub](https://hub.docker.com/r/harisekhon/spotify-tools/).

List all programs:
```
docker run harisekhon/spotify-tools
```
Run any given program:
```
docker run harisekhon/spotify-tools <program> <args>
```

#### Automated Build from source #####

```
git clone https://github.com/harisekhon/spotify-tools
cd spotify
make
```

This fetches my library submodule and a few cpan modules.

Alternatively see the [Manual Setup](https://github.com/harisekhon/spotify-tools#manual-setup) section instead.

### Spotify Lookup - Usage ###

You can copy and paste the tracks from Spotify directly into text files, which puts them in Spotify URI format such as
```
http://open.spotify.com/track/61oGXsKgJOI0e3uS2wg1BV
http://open.spotify.com/track/1j6API7GnhE8MRRedK4bda
http://open.spotify.com/track/0RxFoUhB3mAI3qpgLSf7eM
```

Then convert this to readable Artist - Track form for saving independently of Spotify but running spotify-lookup.pl against the file

```
./spotify-lookup.pl Pendulum.txt
Pendulum - Watercolour
Pendulum - Witchcraft
Pendulum - The Island - Pt. I
...
```

You can also pipe the file through standard input or even feed one or more Spotify URIs as standard input in either format that Spotify uses

```
echo http://open.spotify.com/track/5TOYgNohZAFEPOtnchPhZS | ./spotify-lookup.pl
Foo Fighters - Arlandria

echo spotify:track:5TOYgNohZAFEPOtnchPhZS | ./spotify-lookup.pl
Foo Fighters - Arlandria
```

Use verbose mode to print the the URIs to STDERR, so you can send the tracks to a file while still seeing the progress in your terminal

```
./spotify-lookup.pl -v Pendulum_Spotify.txt > Pendulum_Tracks.txt
verbose mode on
verbose level: 1
files:         spotify/Pendulum
speed up:      x1
retries:       3

1/42 http://ws.spotify.com/lookup/1/?uri=spotify:track:61oGXsKgJOI0e3uS2wg1BV => 0.1262 secs
2/42 http://ws.spotify.com/lookup/1/?uri=spotify:track:1j6API7GnhE8MRRedK4bda => 0.0547 secs
3/42 http://ws.spotify.com/lookup/1/?uri=spotify:track:0RxFoUhB3mAI3qpgLSf7eM => 0.0566 secs
...
...
42/42 http://ws.spotify.com/lookup/1/?uri=spotify:track:6gTQubOSdry0ievEXvhzxd => 0.0457 secs

Summary:         42 tracks, 0 local tracks, 42 spotify tracks fetched in 8.6640 secs
Completion Date: Mon Dec 31 15:38:44 GMT 2012
```
The track names are then stored in Pendulum_Tracks.txt. On large playlists you'll want to see this progress. Also it looks cool when it's running :)

The mode I use the most is to translate a list of Spotify URI files I've dumped to another directory, keeping the file names the same and you get a nice total progress listing how many tracks of the current playlist file and how many overall are completed, followed by a total summary at the end.
```
spotify-lookup.pl -v -w music spotify/Pendulum spotify/Foo_Fighters
verbose mode on
verbose level: 1
files:         spotify/Pendulum spotify/Foo_Fighters
write dir:     /Users/hari/music
speed up:      x1
retries:       3

file: 'spotify/Pendulum'
write file: '/Users/hari/music/Pendulum'
1/42 1/53 spotify/Pendulum http://ws.spotify.com/lookup/1/?uri=spotify:track:61oGXsKgJOI0e3uS2wg1BV => 0.1511 secs
2/42 2/53 spotify/Pendulum http://ws.spotify.com/lookup/1/?uri=spotify:track:1j6API7GnhE8MRRedK4bda => 0.0520 secs
3/42 3/53 spotify/Pendulum http://ws.spotify.com/lookup/1/?uri=spotify:track:0RxFoUhB3mAI3qpgLSf7eM => 0.0507 secs
42/42 42/53 spotify/Pendulum http://ws.spotify.com/lookup/1/?uri=spotify:track:6gTQubOSdry0ievEXvhzxd => 0.1757 secs
Wrote: /Users/hari/music/Pendulum

file: 'spotify/Foo_Fighters'
write file: '/Users/hari/music/Foo_Fighters'
1/11 43/53 spotify/Foo_Fighters http://ws.spotify.com/lookup/1/?uri=spotify:track:042RaY48TNY9aesv8fqYTf => 0.0606 secs
2/11 44/53 spotify/Foo_Fighters http://ws.spotify.com/lookup/1/?uri=spotify:track:0mWiuXuLAJ3Brin3Or2x6v => 0.0787 secs
...
11/11 53/53 spotify/Foo_Fighters http://ws.spotify.com/lookup/1/?uri=spotify:track:7v0mtl6oInUtHOmTk2b0gC => 0.0594 secs
Wrote: /Users/hari/music/Foo_Fighters


Summary:         53 tracks, 0 local tracks, 53 spotify tracks fetched in 5.6081 secs
Completion Date: Mon Dec 31 15:46:33 GMT 2012
```

For full list of options see --help

### Spotify Lookup --help ###

```
./spotify-lookup --help

Filter program to convert Spotify URIs to 'Artist - Track' form by querying the
Spotify Metadata API

usage: spotify-lookup.pl [ options ]

-f  --file          File name(s) containing the spotify URLs
-a  --album         Print Album name at end of track [Album:<name>]
    --territory     Give a 2 letter territory code to suffix tracks that aren't
                    available in that territory with '(Unavailable in GB)'.
                    I've found this to be unreliable information from Spotify,
                    not currently recommended
    --mark-local    Suffix local tracks with '(Local Track)'
-r  --retries       Number of retires (defaults to 5)
-w  --write-dir     Write to file of same name in directory path given as
                    argument (cannot be the same as the source directory)
-s  --speed-up      Speeds up by reducing default sleep between lookups (0.1
                    secs) by this factor, useful if you're beind a pool of DIPs
                    at work ;)
-n  --no-locking    Do not lock, allow more than 1 copy of this program to run
                    at a time. This could get you blocked by Spotify's rate
                    limiting on their metadata API. Use with caution, only if
                    you are behind a network setup that gives you multiple IP
                    addresses
    --sort          Sort the resulting file (only used with --write-dir)
    --wait          Wait to acquire spotify lock instead of exiting
-t  --timeout       Timeout in secs (default: 10000). There is also 30 second
                    timeout on each track translation request to the Spotify
                    API
-v  --verbose       Verbose mode (-v, -vv, -vvv ...)
-h  --help          Print description and usage options
-V  --version       Print version and exit
```

### Spotify Cmd --help ###

```
./spotify-cmd.pl --help

Command line interface to Spotify on Mac that leverages AppleScript

Useful for automation that Mac HotKeys don't help with, such as auto skipping
to next track every N secs to sample a playlist while working

usage: spotify-cmd.pl <command>

commands:

play            Play
pause / stop    Pause
playpause       Toggle Play/Pause
previous        Previous Track and print previous track information
next [secs]     Next Track and print next track information.
                Specifying optional secs will skip to next track
                every [secs] seconds. Handy for skipping through a playlist
                every 60 secs automatically and grabbing the good songs. Prints
                track information every time it skips to the next track

status          Show current track details

vol up          Turn volume up
vol down        Turn volume down
vol <1-100>     Set volume to number <1-100>

exit / quit     Exit Spotify

-q  --quiet      Quiet mode. Do not print track information or volume after
                 completing action
-t  --timeout    Timeout in secs (default: 10)
-v  --verbose    Verbose mode (-v, -vv, -vvv ...)
-h  --help       Print description and usage options
-V  --version    Print version and exit
```

#### Manual Setup ####

Enter the directory and run git submodule init and git submodule update to fetch my library repo:

```
git clone https://github.com/harisekhon/spotify-tools
cd spotify
git submodule init
git submodule update
```

Then you will also need to fetch the following CPAN modules:

JSON
LWP::Simple
Text::Unidecode
URI::Escape
XML::Simple

Running the cpan command followed by the list of modules (as root) will fetch them for you:

```
cpan LWP::Simple Text::Unidecode URI::Escape XML::Simple
```

### Contributions ###

Patches, improvements and even general feedback are welcome in the form of GitHub pull requests and issue tickets.

### Updating ###

Run ```make update```. This will git pull and then git submodule update which is necessary to pick up corresponding library updates.
ndencies.

If you update often and want to just quickly git pull + submodule update but skip rebuilding all those dependencies each time then run ```make update-no-recompile``` (will miss new library dependencies - do full ```make update``` if you encounter issues).

[git.io/spotify](https://git.io/spotify)
